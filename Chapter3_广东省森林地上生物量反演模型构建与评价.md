## 3 广东省森林地上生物量反演模型构建与评价
### 3.1 模型构建与评价

本研究的建模样本来源于经过筛选的GEDI L4A足迹级AGB观测。筛选后共得到475720个有效足迹，为保证计算效率并避免类别不平衡带来的偏差，采用分层随机抽样的方式中抽取15000个样本用于模型训练与验证。


本研究采用XGBoost进行建模。XGBoost（Extreme Gradient Boosting）在传统 GBDT 的基础上引入二阶梯度信息、正则化项和并行计算框架，能够在抑制过拟合的同时提升运算效率，适合处理高维、多源遥感特征\cite{li2023county}。模型超参数通过 10 折交叉验证自动搜索：将15000条样本均分为十折，轮流以一折为验证集、其余九折为训练集，记录平均训练损失和验证损失，最终确定学习率、子采样率、最大树深等最优组合。

初步构建的特征集包括67个变量。为提高模型效率、减少冗余特征带来的过拟合风险，本研究基于XGBoost模型内部的基尼重要性排序（feature importance by gain），筛选出排名前20的特征用于建模。筛选后的变量包括 'B2',
'B3',
'MNDWI',
'NDVI8A5',
'NDVI8A6',
'NDVI8A7', 
'NDVI8A5\_ent', 
'NDVI87\_var', 
'NDVI8A4\_var', 
'NDVI87\_contrast',
'S1\_RVI',
'S1\_sum', 
'S1\_diff',
'S1\_rept', 
'VH\_contrast',
'VV\_contrast', 
'VV\_diss',
'VV\_corr',
'Elevation',
'Slope'。

本研究采用10折交叉验证（10-fold cross-validation）对模型进行训练与评估。将15000条样本均分为十折，轮流以一折为验证集、其余九折为训练集，记录各折的评估指标，最终以10折平均结果作为模型精度。模型预测精度通过决定系数R<sup>2</sup>、均方根误差(RMSE) 和平均绝对误差(MAE) 进行衡量：

$$R^2 = 1 - \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}$$

$$ \text{RMSE} = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2} $$

$$ \text{MAE} = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i| $$

其中 $y_{i}$ 为观测值， $\hat{y}_{i}$ 为预测值， $\bar{y}$ 为观测均值， $n$ 为样本数。


为验证 XGBoost 的优势，选取多元线性回归 (MLR)、支持向量机回归 (SVM) 与随机森林 (RF) 三种常用算法，在相同的15000条样本和同一组20个自变量上独立训练。